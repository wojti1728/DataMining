hist(wastewater$Sandomierz, breaks=8)
library(dplyr)
install.packages("dplyr")
install.packages("dplyr")
library(dplyr)
wastewater <- wastewater %>%
mutate(a_Sandomierz = ifelse(Sandomierz < 0 | Sandomierz > 20, NA, Sandomierz))
wastewater
setwd("D:/AGH-studia/Semestr_7/Data_Mininig/cw2")
wastewater <- read.table("wastewater.txt",header = TRUE, sep = "\t")
library(dplyr)
wastewater <- wastewater %>%
mutate(a_Sandomierz = ifelse(Sandomierz < 0 | Sandomierz > 20, NA, Sandomierz))
wastewater
wastewater <- wastewater %>%
mutate(a_Sandomierz = ifelse(Sandomierz < 0 | Sandomierz > 7.5, NA, Sandomierz))
wastewater
boxplot(wastewater$a_Sandomierz)
plot(wastewater$a_Sandomierz, type="l")
hist(wastewater$a_Sandomierz, breaks=8)
acf(szereg_czasowy, na.action = na.pass)
par(mfrow=c(2,1))
acf(szereg_czasowy, na.action = na.pass)
par(mfrow=c(2,1))
acf(szereg_czasowy, na.action = na.pass)
installed.packages("zoo")
library(zoo)
library('zoo')
library("zoo")
install.packages("zoo")
library("zoo")
library('zoo')
# zad 4
cars <- read.table("cars.txt",header = TRUE, sep = "\t")
str(cars)
str(cars)
cars<-read.delim("cars.txt")
str(cars)
# zad 4
cars <- read.table("cars.txt",header = TRUE, sep = "\t")
cars<-read.delim("cars.txt")
str(cars)
view(cars)
View(cars)
cars<-read.delim("cars.txt")
str(cars)
View(cars)
# zad 4
cars <- read.table("cars.txt",header = TRUE, sep = ",")
cars<-read.delim("cars.txt")
str(cars)
View(cars)
# zad 4
cars <- read.table("cars.txt",header = TRUE, sep = ",")
cars<-read.delim("cars.txt")
str(cars)
View(cars)
# zad 4
cars <- read.table("cars.txt",header = TRUE, sep = ",")
View(cars)
# zad 4
cars <- read.table("cars.txt",header = TRUE, sep = ",")
str(cars)
str(cars)
# zad 4
cars <- read.table("cars.txt",header = TRUE, sep = ",", colClasses = c("numeric", "integer", "double","integer","integer","integer","integer","character" ))
# zad 4
cars <- read.table("cars.txt",header = TRUE, sep = ",", colClasses = c("numeric", "integer", "double","integer","integer","integer","integer","character" ))
# zad 4
cars <- read.table("cars.txt",header = TRUE, sep = ",") #, colClasses = c("numeric", "integer", "double","integer","integer","integer","integer","character" ))
cars <-
str(cars)
cars$cubicinches <- as.numeric(cars$cubicinches)
str(cars)
str(cars)
# zad 4
cars <- read.table("cars.txt",header = TRUE, sep = ",") #, colClasses = c("numeric", "integer", "double","integer","integer","integer","integer","character" ))
cars$cubicinches <- as.numeric(cars$cubicinches)
str(cars)
View(cars)
str(cars)
View(cars)
#histogramy
par(mfrow=c(3,2))
hist(cars$cylinders)
hist(cars$cylinders)
hist(cars$hp)
hist(cars$mpg)
hist(cars$cubicinches)
hist(cars$weightlbs)
hist(cars$time.to.60)
#histogramy
par(mfrow=c(3,2))
hist(cars$cylinders)
hist(cars$hp)
hist(cars$mpg)
hist(cars$cubicinches)
hist(cars$weightlbs)
hist(cars$time.to.60)
#histogramy
par(mfrow=c(3,3))
hist(cars$cylinders)
hist(cars$hp)
hist(cars$mpg)
hist(cars$cubicinches)
hist(cars$weightlbs)
hist(cars$time.to.60)
hist(cars$year)
hist(cars$brand)
cars = cars %>%
mutate(mpg2 = ifelse(cars$mpg < 0 | cars$mpg > 70, NA, cars$mpg),
cylinders2 = ifelse(cars$cylinders > 8, NA, cars$cylinders),
cubicinches2 = ifelse(cars$cubicinches > 400, NA, cars$cubicinches),
hp2 = ifelse(cars$hp > 300, NA, cars$hp))
cars
cars = cars %>%
mutate(mpg2 = ifelse(cars$mpg < 0 | cars$mpg > 70, NA, cars$mpg),
cylinders2 = ifelse(cars$cylinders > 8, NA, cars$cylinders),
cubicinches2 = ifelse(cars$cubicinches > 400, NA, cars$cubicinches),
hp2 = ifelse(cars$hp > 300, NA, cars$hp))
cars
View(cars)
cars = cars %>%
mutate(mpg2 = ifelse(cars$mpg < 0 | cars$mpg > 70, NA, cars$mpg),
cylinders2 = ifelse(cars$cylinders > 8, NA, cars$cylinders),
cubicinches2 = ifelse(cars$cubicinches > 400, NA, cars$cubicinches),
hp2 = ifelse(cars$hp > 300, NA, cars$hp))
View(cars)
cars<-distinct(cars)
View(cars)
# zad 4
cars <- read.table("cars.txt",header = TRUE, sep = ",") #, colClasses = c("numeric", "integer", "double","integer","integer","integer","integer","character" ))
cars$cubicinches <- as.numeric(cars$cubicinches)
cars = cars %>%
mutate(mpg2 = ifelse(cars$mpg < 0 | cars$mpg > 70, NA, cars$mpg),
cylinders2 = ifelse(cars$cylinders > 8, NA, cars$cylinders),
cubicinches2 = ifelse(cars$cubicinches > 400, NA, cars$cubicinches),
hp2 = ifelse(cars$hp > 300, NA, cars$hp))
View(cars)
cars<-distinct(cars)
View(cars)
cars$mpg2 = na.approx(cars$mpg2, rule=2)
cars$cylinders2 = na.approx(cars$cylinders2, rule=2)
auta$cubicinches2 = na.approx(auta$cubicinches2, rule = 2)
auta$hp2 = na.approx(auta$hp2, rule = 2)
cars$mpg2 = na.approx(cars$mpg2, rule=2)
cars$cylinders2 = na.approx(cars$cylinders2, rule=2)
cars$cubicinches2 = na.approx(cars$cubicinches2, rule = 2)
cars$hp2 = na.approx(cars$hp2, rule = 2)
View(cars)
par(mfrow=c(3,3))
hist(cars$cylinders2)
hist(cars$hp2)
hist(cars$mpg2)
hist(cars$cubicinches2)
sum_sd<-cars %>%
summary(cars)
sum_sd<-cars %>%
summary(cars)
sum_sd
sum_sd<-cars %>%
group_by(cars$brand) %>%
summary(cars)
sum_sd
sum_sd<-cars %>%
group_by(cars$brand) %>%
sum_sd
sum_sd<-cars %>%
group_by(cars$brand)
sum_sd
summary(sum_sd)
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
View(cars)
cars <- read.table("cars.txt",header = TRUE, sep = ",")
cars$cubicinches <- as.numeric(cars$cubicinches)
str(cars)
summary(cars)
library(dplyr)
library(zoo)
library(ggplot2)
str(cars)
summary(cars)
par(mfrow=c(3,3))
hist(cars$cylinders)
hist(cars$hp)
hist(cars$mpg)
hist(cars$cubicinches)
hist(cars$weightlbs)
hist(cars$time.to.60)
hist(cars$year)
cars = cars %>%
mutate(mpg2 = ifelse(cars$mpg < 0 | cars$mpg > 70, NA, cars$mpg),
cylinders2 = ifelse(cars$cylinders > 8, NA, cars$cylinders),
cubicinches2 = ifelse(cars$cubicinches > 400, NA, cars$cubicinches),
hp2 = ifelse(cars$hp > 300, NA, cars$hp))
cars<-distinct(cars)
cars$mpg2 = na.approx(cars$mpg2, rule=2)
cars$cylinders2 = na.approx(cars$cylinders2, rule=2)
cars$cubicinches2 = na.approx(cars$cubicinches2, rule = 2)
cars$hp2 = na.approx(cars$hp2, rule = 2)
cars = cars %>%
mutate(mpg2 = ifelse(cars$mpg < 0 | cars$mpg > 70, NA, cars$mpg),
cylinders2 = ifelse(cars$cylinders > 8, NA, cars$cylinders),
cubicinches2 = ifelse(cars$cubicinches > 400, NA, cars$cubicinches),
hp2 = ifelse(cars$hp > 300, NA, cars$hp))
cars<-distinct(cars)
cars = cars %>%
mutate(mpg2 = ifelse(cars$mpg < 0 | cars$mpg > 70, NA, cars$mpg),
cylinders2 = ifelse(cars$cylinders > 8, NA, cars$cylinders),
cubicinches2 = ifelse(cars$cubicinches > 400, NA, cars$cubicinches),
hp2 = ifelse(cars$hp > 300, NA, cars$hp))
cars<-distinct(cars)
cars = cars %>%
mutate(mpg2 = ifelse(cars$mpg < 0 | cars$mpg > 70, NA, cars$mpg),
cylinders2 = ifelse(cars$cylinders > 8, NA, cars$cylinders),
cubicinches2 = ifelse(cars$cubicinches > 400, NA, cars$cubicinches),
hp2 = ifelse(cars$hp > 300, NA, cars$hp))
cars<-distinct(cars)
cars$mpg2 = na.approx(cars$mpg2, rule=2)
cars$cylinders2 = na.approx(cars$cylinders2, rule=2)
cars$cubicinches2 = na.approx(cars$cubicinches2, rule = 2)
cars$hp2 = na.approx(cars$hp2, rule = 2)
par(mfrow=c(3,3))
hist(cars$cylinders2)
hist(cars$hp2)
hist(cars$mpg2)
hist(cars$cubicinches2)
cars <- read.table("cars.txt",header = TRUE, sep = ",")
cars$cubicinches <- as.numeric(cars$cubicinches)
str(cars)
summary(cars)
par(mfrow=c(3,3))
hist(cars$cylinders)
hist(cars$hp)
hist(cars$mpg)
hist(cars$cubicinches)
hist(cars$weightlbs)
hist(cars$time.to.60)
hist(cars$year)
cars2 = cars %>%
mutate(mpg2 = ifelse(cars$mpg < 0 | cars$mpg > 70, NA, cars$mpg),
cylinders2 = ifelse(cars$cylinders > 8, NA, cars$cylinders),
cubicinches2 = ifelse(cars$cubicinches > 400, NA, cars$cubicinches),
hp2 = ifelse(cars$hp > 300, NA, cars$hp))
cars2<-distinct(cars2)
cars2$mpg2 = na.approx(car2s$mpg2, rule=2)
cars2$mpg2 = na.approx(cars2$mpg2, rule=2)
cars2$cylinders2 = na.approx(cars2$cylinders2, rule=2)
cars2$cubicinches2 = na.approx(cars2$cubicinches2, rule = 2)
cars2$hp2 = na.approx(cars2$hp2, rule = 2)
par(mfrow=c(3,3))
hist(cars2$cylinders2)
hist(cars2$hp2)
hist(cars2$mpg2)
hist(cars2$cubicinches2)
cars3 <- cars %>%
group_by(brand) %>%
mutate(
hp=ifelse(is.na(hp), mean(hp, na.rm = TRUE),hp),
mpg=ifelse(is.na(mpg), mean(mpg, na.rm = TRUE), mpg),
cubicinches=ifelse(is.na(cubicinches), mean(cubicinches, na.rm = TRUE), cubicinches),
cylinders=ifelse(is.na(cylinders),as.numeric(names(sort(table(cylinders)))[1]),cylinders)
) %>%
ungroup()
par(mfrow=c(2,2))
hist(cars2$cylinders2)
hist(cars2$hp2)
hist(cars2$mpg2)
hist(cars2$cubicinches2)
```{r}
par(mfrow=c(2,2))
hist(cars3$cylinders2)
par(mfrow=c(2,2))
hist(cars3$cylinders)
hist(cars3$hp)
hist(cars3$mpg)
hist(cars3$cubicinches)
par(mfrow=c(2,2))
hist(cars3$cylinders2)
cars3
cars2 = cars %>%
mutate(mpg2 = ifelse(cars$mpg < 0 | cars$mpg > 70, NA, cars$mpg),
cylinders2 = ifelse(cars$cylinders > 8, NA, cars$cylinders),
cubicinches2 = ifelse(cars$cubicinches > 400, NA, cars$cubicinches),
hp2 = ifelse(cars$hp > 300, NA, cars$hp))
cars3<-cars2
cars2<-distinct(cars2)
cars3 <- cars3 %>%
group_by(brand) %>%
mutate(
hp2=ifelse(is.na(hp2), mean(hp2, na.rm = TRUE),hp),
mpg2=ifelse(is.na(mpg2), mean(mpg2, na.rm = TRUE), mpg),
cubicinches2=ifelse(is.na(cubicinches2), mean(cubicinches2, na.rm = TRUE), cubicinches2),
cylinders2=ifelse(is.na(cylinders2),as.numeric(names(sort(table(cylinders2)))[1]),cylinders)
) %>%
ungroup()
cars3
hist(cars3$hp2)
par(mfrow=c(2,2))
hist(cars3$cylinders2)
hist(cars3$hp2)
hist(cars3$mpg2)
hist(cars3$cubicinches2)
par(mfrow=c(2,2))
plot(cars3$cylinders2, type="l")
plot(cars3$hp2, type="l")
plot(cars3$mpg2, type="l")
plot(cars3$cubicinches2, type="l")
cars2 = cars %>%
mutate(mpg2 = ifelse(cars$mpg < 0 | cars$mpg > 70, NA, cars$mpg),
cylinders2 = ifelse(cars$cylinders > 8 | cars$cylinders < 2 , NA, cars$cylinders),
cubicinches2 = ifelse(cars$cubicinches > 400, NA, cars$cubicinches),
hp2 = ifelse(cars$hp > 300, NA, cars$hp))
cars3<-cars2
cars2<-distinct(cars2)
cars2$mpg2 = na.approx(cars2$mpg2, rule=2)
cars2$cylinders2 = na.approx(cars2$cylinders2, rule=2)
cars2$cubicinches2 = na.approx(cars2$cubicinches2, rule = 2)
cars2$hp2 = na.approx(cars2$hp2, rule = 2)
par(mfrow=c(2,2))
hist(cars2$cylinders2)
hist(cars2$hp2)
hist(cars2$mpg2)
hist(cars2$cubicinches2)
cars3 <- cars3 %>%
group_by(brand) %>%
mutate(
hp2=ifelse(is.na(hp2), mean(hp2, na.rm = TRUE),hp),
mpg2=ifelse(is.na(mpg2), mean(mpg2, na.rm = TRUE), mpg),
cubicinches2=ifelse(is.na(cubicinches2), mean(cubicinches2, na.rm = TRUE), cubicinches2),
cylinders2=ifelse(is.na(cylinders2),as.numeric(names(sort(table(cylinders2)))[1]),cylinders)
) %>%
ungroup()
cars3
par(mfrow=c(2,2))
hist(cars3$cylinders2)
hist(cars3$hp2)
hist(cars3$mpg2)
hist(cars3$cubicinches2)
par(mfrow=c(2,2))
plot(cars3$cylinders2, type="l")
plot(cars3$hp2, type="l")
plot(cars3$mpg2, type="l")
plot(cars3$cubicinches2, type="l")
cars2 = cars %>%
mutate(mpg2 = ifelse(cars$mpg < 0 | cars$mpg > 70, NA, cars$mpg),
cylinders2 = ifelse(cars$cylinders > 8 | cars$cylinders < 2 , NA, cars$cylinders),
cubicinches2 = ifelse(cars$cubicinches > 400 | hp < 0, NA, cars$cubicinches),
hp2 = ifelse(cars$hp > 300, NA, cars$hp))
cars3<-cars2
cars2<-distinct(cars2)
par(mfrow=c(2,2))
hist(cars2$cylinders2)
hist(cars2$hp2)
hist(cars2$mpg2)
hist(cars2$cubicinches2)
par(mfrow=c(2,2))
hist(cars2$cylinders2)
hist(cars2$hp2)
hist(cars2$mpg2)
hist(cars2$cubicinches2)
cars2 = cars %>%
mutate(mpg2 = ifelse(cars$mpg < 0 | cars$mpg > 70, NA, cars$mpg),
cylinders2 = ifelse(cars$cylinders > 8 | cars$cylinders < 2 , NA, cars$cylinders),
cubicinches2 = ifelse(cars$cubicinches > 400 | hp < 0, NA, cars$cubicinches),
hp2 = ifelse(cars$hp > 300, NA, cars$hp))
cars3<-cars2
cars2<-distinct(cars2)
cars2$mpg2 = na.approx(cars2$mpg2, rule=2)
cars2$cylinders2 = na.approx(cars2$cylinders2, rule=2)
cars2$cubicinches2 = na.approx(cars2$cubicinches2, rule = 2)
cars2$hp2 = na.approx(cars2$hp2, rule = 2)
par(mfrow=c(2,2))
hist(cars2$cylinders2)
hist(cars2$hp2)
hist(cars2$mpg2)
hist(cars2$cubicinches2)
cars3 <- cars3 %>%
group_by(brand) %>%
mutate(
hp2=ifelse(is.na(hp2), mean(hp2, na.rm = TRUE),hp),
mpg2=ifelse(is.na(mpg2), mean(mpg2, na.rm = TRUE), mpg),
cubicinches2=ifelse(is.na(cubicinches2), mean(cubicinches2, na.rm = TRUE), cubicinches2),
cylinders2=ifelse(is.na(cylinders2),as.numeric(names(sort(table(cylinders2)))[1]),cylinders)
) %>%
ungroup()
cars3
par(mfrow=c(2,2))
hist(cars3$cylinders2)
hist(cars3$hp2)
hist(cars3$mpg2)
hist(cars3$cubicinches2)
par(mfrow=c(2,2))
plot(cars3$cylinders2, type="l")
plot(cars3$hp2, type="l")
plot(cars3$mpg2, type="l")
plot(cars3$cubicinches2, type="l")
cars2 = cars %>%
mutate(mpg2 = ifelse(cars$mpg < 0 | cars$mpg > 70, NA, cars$mpg),
cylinders2 = ifelse(cars$cylinders > 8 | cars$cylinders < 2 , NA, cars$cylinders),
cubicinches2 = ifelse(cars$cubicinches > 400, NA, cars$cubicinches),
hp2 = ifelse(cars$hp > 300 | cars$hp < 0, NA, cars$hp))
cars3<-cars2
cars2<-distinct(cars2)
cars2$mpg2 = na.approx(cars2$mpg2, rule=2)
cars2$cylinders2 = na.approx(cars2$cylinders2, rule=2)
cars2$cubicinches2 = na.approx(cars2$cubicinches2, rule = 2)
cars2$hp2 = na.approx(cars2$hp2, rule = 2)
par(mfrow=c(2,2))
hist(cars2$cylinders2)
hist(cars2$hp2)
hist(cars2$mpg2)
hist(cars2$cubicinches2)
cars3 <- cars3 %>%
group_by(brand) %>%
mutate(
hp2=ifelse(is.na(hp2), mean(hp2, na.rm = TRUE),hp),
mpg2=ifelse(is.na(mpg2), mean(mpg2, na.rm = TRUE), mpg),
cubicinches2=ifelse(is.na(cubicinches2), mean(cubicinches2, na.rm = TRUE), cubicinches2),
cylinders2=ifelse(is.na(cylinders2),as.numeric(names(sort(table(cylinders2)))[1]),cylinders)
) %>%
ungroup()
cars3
par(mfrow=c(2,2))
hist(cars3$cylinders2)
hist(cars3$hp2)
hist(cars3$mpg2)
hist(cars3$cubicinches2)
par(mfrow=c(2,2))
plot(cars3$cylinders2, type="l")
plot(cars3$hp2, type="l")
plot(cars3$mpg2, type="l")
plot(cars3$cubicinches2, type="l")
mean(cars$a_mpg,na.rm=TRUE) + (3*sd(cars$a_mpg,na.rm = TRUE))#46.85138
mean(cars$a_mpg,na.rm=TRUE) - (3*sd(cars$a_mpg,na.rm = TRUE))#-0.7326
mean(cars$mpg,na.rm=TRUE) + (3*sd(cars$mpg,na.rm = TRUE))#46.85138
mean(cars$mpg,na.rm=TRUE) - (3*sd(cars$mpg,na.rm = TRUE))#-0.7326
mean(cars2$mpg2,na.rm=TRUE) + (3*sd(cars2$mpg2,na.rm = TRUE))#46.85138
mean(cars2$mpg2,na.rm=TRUE) - (3*sd(cars2$mpg2,na.rm = TRUE))#-0.7326
mean(cars2$mpg2,na.rm=TRUE) + (3*sd(cars2$mpg2,na.rm = TRUE))#46.94349
mean(cars2$mpg2,na.rm=TRUE) - (3*sd(cars2$mpg2,na.rm = TRUE))#-1.174138
cars4<-mutate(cars2, mpg2=ifelse(mpg2<46.85 & mpg2>-0.732,mpg2,NA))
boxplot(cars4$mpg2)
plot(cars4$mpg2, type="l")
hist(cars4$mpg2, breaks=8)
par(mfrow=c(3,1))
boxplot(cars4$mpg2)
plot(cars4$mpg2, type="l")
hist(cars4$mpg2, breaks=8)
par(mfrow=c(2,2))
boxplot(cars4$mpg2)
plot(cars4$mpg2, type="l")
hist(cars4$mpg2, breaks=8)
cars <- read.table("cars.txt",header = TRUE, sep = ",")
cars$cubicinches <- as.numeric(cars$cubicinches)
str(cars)
summary(cars)
par(mfrow=c(3,3))
hist(cars$cylinders)
hist(cars$hp)
hist(cars$mpg)
hist(cars$cubicinches)
hist(cars$weightlbs)
hist(cars$time.to.60)
hist(cars$year)
cars2 = cars %>%
mutate(mpg2 = ifelse(cars$mpg < 0 | cars$mpg > 70, NA, cars$mpg),
cylinders2 = ifelse(cars$cylinders > 8 | cars$cylinders < 2 , NA, cars$cylinders),
cubicinches2 = ifelse(cars$cubicinches > 400, NA, cars$cubicinches),
hp2 = ifelse(cars$hp > 300 | cars$hp < 0, NA, cars$hp))
cars3<-cars2
cars2<-distinct(cars2)
cars2$mpg2 = na.approx(cars2$mpg2, rule=2)
cars2$cylinders2 = na.approx(cars2$cylinders2, rule=2)
cars2$cubicinches2 = na.approx(cars2$cubicinches2, rule = 2)
cars2$hp2 = na.approx(cars2$hp2, rule = 2)
par(mfrow=c(2,2))
hist(cars2$cylinders2)
hist(cars2$hp2)
hist(cars2$mpg2)
hist(cars2$cubicinches2)
cars3 <- cars3 %>%
group_by(brand) %>%
mutate(
hp2=ifelse(is.na(hp2), mean(hp2, na.rm = TRUE),hp),
mpg2=ifelse(is.na(mpg2), mean(mpg2, na.rm = TRUE), mpg),
cubicinches2=ifelse(is.na(cubicinches2), mean(cubicinches2, na.rm = TRUE), cubicinches2),
cylinders2=ifelse(is.na(cylinders2),as.numeric(names(sort(table(cylinders2)))[1]),cylinders)
) %>%
ungroup()
cars3
par(mfrow=c(2,2))
hist(cars3$cylinders2)
hist(cars3$hp2)
hist(cars3$mpg2)
hist(cars3$cubicinches2)
par(mfrow=c(2,2))
plot(cars3$cylinders2, type="l")
plot(cars3$hp2, type="l")
plot(cars3$mpg2, type="l")
plot(cars3$cubicinches2, type="l")
mean(cars2$mpg2,na.rm=TRUE) + (3*sd(cars2$mpg2,na.rm = TRUE))#46.94349
mean(cars2$mpg2,na.rm=TRUE) - (3*sd(cars2$mpg2,na.rm = TRUE))#-1.174138
cars4<-mutate(cars2, mpg2=ifelse(mpg2<46.85 & mpg2>-0.732,mpg2,NA))
par(mfrow=c(2,2))
boxplot(cars4$mpg2)
plot(cars4$mpg2, type="l")
hist(cars4$mpg2, breaks=8)
